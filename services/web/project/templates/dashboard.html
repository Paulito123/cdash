<!-- templates/dashboard.html -->

{% extends "base.html" %}

{% block content %}
<div class="box">
  <div class="columns">
    <div class="column">
      Total balance:<br /><strong>{{ totalbalance/1000 }}</strong>
    </div>
    <div class="column">
      Number of miners:<br /><strong>{{ nrofaccounts }}</strong>
    </div>
    <div class="column">
      Total proofs mined:<br /><strong>{{ totalheight }}</strong>
    </div>
    <div class="column">
      Last data refresh:<br /><strong>{{ lastupdate }}</strong>
    </div>
  </div>
  <div class="columns">
    <div class="column">
      Last epoch mined:<br /><strong>{{ lastepochmined }}</strong>
    </div>
    <div class="column">
      AVG time per proof:<br /><strong>0</strong>
    </div>
    <div class="column">
      AVG nr of proofs epoch {{ lastepochmined-1 }}:<br /><strong>{{ avg_proofs_mined_last_epoch }}</strong>
    </div>
    <div class="column">
      Rewards epoch {{ lastepochmined-1 }}<br /><strong>{{ rewards_last_epoch / 1000 }}</strong>
    </div>
  </div>
</div>
<table class="table">
  <tr>
    <th>Name</th>
    <th>Address</th>
    <th>Balance</th>
    <th>Tower <br />height</th>
    <th>Proofs <br />in epoch</th>
    <th>Last <br />epoch</th>
    <th>Yield evolution 10 last epochs</th>
  </tr>
  {% for row in rows %}
  <tr>
    <td class="px-1">{{ row.name }}</td>
    <td class="px-1">{{ row.address }}</td>
    <td class="px-1">{{ row.balance/1000 }}</td>
    <td class="px-1">{{ row.towerheight }}</td>
    <td class="px-1">{{ row.proofsinepoch }}</td>
    <td class="px-1">{{ row.lastepochmined }}</td>
    <td class="px-1">
      <canvas id="lineChart" width="300" height="80"></canvas>
      <script>
        var ctx = document.getElementById("lineChart").getContext("2d");
        var lineChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: {{ labels | safe }},
            datasets: [
              {
                label: "bla",
                data: {{ values | safe }},
                fill: false,
                lineTension: 0.1
              }
            ]
          },
          options: {
            scales:{
              x: {
                display: false
              }
            },
            responsive: false,
            plugins: {
              legend: {
                  display: false,
              }
            }
          }
        });
      </script>
    </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}